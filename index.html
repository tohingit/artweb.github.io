<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мини-игра: Прыгающий круг</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        canvas {
            background-color: #f9f9f9;
            border: 2px solid #000;
        }
    </style>
</head>
<body>

<canvas id="gameCanvas" width="400" height="600"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    let score = 0;
    let gravity = 0.6;
    let jump = -10;
    let platforms = [];
    let isGameOver = false;

    const player = {
        x: 200,
        y: 300,
        radius: 20,
        dy: 0,
        color: '#ff0000',
        isJumping: false
    };

    // Создание платформ
    function createPlatforms() {
        for (let i = 0; i < 5; i++) {
            let platform = {
                x: Math.random() * (canvas.width - 70),
                y: i * 120,
                width: 70,
                height: 10,
                color: '#00ff00'
            };
            platforms.push(platform);
        }
    }

    function drawPlayer() {
        ctx.beginPath();
        ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2);
        ctx.fillStyle = player.color;
        ctx.fill();
        ctx.closePath();
    }

    function drawPlatforms() {
        platforms.forEach(platform => {
            ctx.fillStyle = platform.color;
            ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
        });
    }

    function updatePlatforms() {
        platforms.forEach(platform => {
            platform.y += 2;

            // Перемещение платформ в начало, если они исчезли за пределами экрана
            if (platform.y > canvas.height) {
                platform.y = -10;
                platform.x = Math.random() * (canvas.width - 70);
                score++;
            }

            // Проверка столкновения игрока с платформой
            if (player.dy > 0 &&
                player.y + player.radius > platform.y &&
                player.y + player.radius < platform.y + platform.height &&
                player.x + player.radius > platform.x &&
                player.x - player.radius < platform.x + platform.width) {
                player.isJumping = true;
                player.dy = jump;
            }
        });
    }

    function updatePlayer() {
        player.dy += gravity;
        player.y += player.dy;

        // Игрок возвращается наверх, если падает
        if (player.y + player.radius > canvas.height) {
            isGameOver = true;
        }

        if (player.y - player.radius < 0) {
            player.y = 0 + player.radius;
        }
    }

    function gameLoop() {
        if (isGameOver) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = '30px Arial';
            ctx.fillStyle = '#000';
            ctx.fillText('Игра окончена!', 100, 300);
            ctx.fillText('Счет: ' + score, 150, 350);
            return;
        }

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        drawPlayer();
        drawPlatforms();
        updatePlayer();
        updatePlatforms();

        ctx.font = '20px Arial';
        ctx.fillStyle = '#000';
        ctx.fillText('Счет: ' + score, 10, 30);

        requestAnimationFrame(gameLoop);
    }

    document.addEventListener('click', function () {
        if (!isGameOver) {
            player.isJumping = true;
            player.dy = jump;
        } else {
            // Сброс игры после окончания
            platforms = [];
            score = 0;
            player.y = 300;
            player.dy = 0;
            isGameOver = false;
            createPlatforms();
        }
    });

    createPlatforms();
    gameLoop();
</script>

</body>
</html>
